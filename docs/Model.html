<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Bayesian model for diversity estimates</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/master/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Introduction.html">Introduction</a>
</li>
<li>
  <a href="Model.html">Bayesian model</a>
</li>
<li>
  <a href="Diversity.html">Diversity</a>
</li>
<li>
  <a href="Function_usage.html">Functions</a>
</li>
<li>
  <a href="example.html">Examples</a>
</li>
<li>
  <a href="model_validering.html">Model validation</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/nbendsen/DataProject">
    <span class="fa fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Bayesian model for diversity estimates</h1>

</div>


<p>The first section of this page will present the ideas behind our proposed model to combine the information from cover data and presence/absence data of a plot. This section will present the beta-binomial cover update model for the reader and show how this can be applied to the problem described at the <a href="Introduction.html">Introduction</a> page. The second section of this page presents an implementation of the model in R. The last section of the page will include a simple example of the use of the model.</p>
<h2>
Presentation of Bayesian model
</h2>
<p>As mentioned on the <a href="Introduction.html">Introduction</a> page, plant diversity is often calculated by species richness using presence/absence data or some other diversity measure using abundance data. Cover data is an example of one type of abundance data. However, when we only use either the presence/absence data or the cover data we loose valuable information about the nature area that we are studying. Furthermore, we also want to take into account the fact that a species does not grow in a uniform distribution throughout an area but follow some spatially aggregated distribution. Each species has its own spatially aggregated distribution and we assume that these are independent of each other.</p>
<p>In the following we work with a nature area in the form of the plots in the NOVANA data. These are defined at the <a href="Introduction.html">Introduction</a> page. We will propose a method that uses the cover data from the small square in the plot and the presence/absence data of the entire plot to obtain an estimate of the species’ cover in the entire plot for the species that we know are present in the plot. Furthermore, the method will take the species spatially aggregated distribution into account. The assumption is that the proposed method will lead to a more accurate diversity estimate of the entire plot than if we only estimated the species diversity from the cover data of the small square or the presence/absence data of the entire plot. To achieve this goal we will apply a Bayesian framework and use a beta-binomial model. <br><br> From the general setup in Bayesian statistics we get <span class="math display">\[
p(\theta|Y =y) \propto f(y|\theta)\cdot \pi(\theta) 
\]</span> where <span class="math inline">\(\theta\)</span> is the model parameters and <span class="math inline">\(y\)</span> is the observed data. Additionally, <span class="math inline">\(f(y|\theta)\)</span> is likelihood function of the observed data, <span class="math inline">\(y\)</span>, given the model parameters, <span class="math inline">\(\theta\)</span> and <span class="math inline">\(p(\theta|Y=y)\)</span> is the density of the posterior distribution. <br> In the Bayesian framework, <span class="math inline">\(\theta\)</span>, is a random variable so we need some prior distribution <span class="math inline">\(\pi(\theta)\)</span> which represents our uncertainty about the model parameters before we observe any data. We are interested in the posterior distribution, <span class="math inline">\(p(\theta|(Y=y))\)</span>, which we can use to estimate the cover of a species in the entire plot. We say that the posterior quantifies the uncertainty about the model parameters that remain after accounting for the prior distribution and the information from the observed data. <br><br> In the cover data for a plot each species is hit by <span class="math inline">\(Y\)</span> pins with <span class="math inline">\(n\)</span> possible with hit probability <span class="math inline">\(\theta\)</span>. A natural distribution to model the number of observed hits is the binomial distribution. Therefore, the likelihood of observing <span class="math inline">\(y\)</span> hits is, thus, given by <span class="math display">\[
f(y|\theta) = \text{Prob}(Y = y| \theta) =  {n \choose y}\theta^y(1-\theta)^{n-y}
\]</span> We use the binomial model as the likelihood function for each species that is present in the plot. We have this knowledge from the presence/absence data of the plot. We want the prior distribution <span class="math inline">\(\pi(\theta)\)</span> to reflect the spatially aggregated distribution for each species. The beta distribution is a conjugate prior for the binomial model and, thus, is ideal to use. The beta distribution is given by <span class="math display">\[
\pi(\theta)= \frac{\Gamma (\alpha+\beta)}{\Gamma (\alpha) \Gamma(\beta)}\theta^{\alpha -1}(1-\theta)^{\beta-1}
\]</span> where both parameters <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> &gt; 0. The beta distribution is defined on the interval <span class="math inline">\([0,1]\)</span> and can therefore be used to model a species relative cover in a plot where we know that the species is present. This is a way to include the spatially aggregated distribution of a species in the model. The fact that we are able to include a spatially aggregated distribution for each species in the form of the prior is really the key idea of using the Bayesian framework.</p>
<p>When working with Bayesian statistics, one has to decide on the parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> in the prior distribution. This can be difficult and one will often choose the prior to be uninformative. However, we are interested in having the prior to reflect the spatial aggregated distribution of a species and have, therefore, chosen to apply the empirical Bayes method. This works as follow: For each species we fit a beta distribution to all the cover data from all the plots where the species has a <span class="math inline">\(1\)</span> in the corresponding presence/absence data. That means we use cover data for the species from all the plots where the species is present. However, we only use the plots from the same tertiary habitat type as we assume that a species follows the same spatial aggregated distribution within a tertiary habitat. In the NOVANA data the cover data is a number between <span class="math inline">\(0\)</span> and <span class="math inline">\(16\)</span>. Therefore, for us to be able to fit a beta distribution to this data we have to first divide the data by <span class="math inline">\(16\)</span> so that we get the relative cover for each species in the plot. <br><br> On the <a href="introduction.html">Introduction</a> page we mentioned that the cover of a species if it is present in the small square of a plot may be well sampled, but not all species within the entire plot is present in the small square. By fitting a beta distribution to the cover data from all the plots where the species is present, we should, hopefully, have enough cover data from plots where the species is present in the small square that we are able to fit a beta distribution that reflects a reasonable spatial aggregated distribution of the species. We, thus, obtain a distribution that reflects our uncertainty about a species cover in a plot where the species is present. By following the ideas of Bayesian inference we can use the observed cover data to update our prior belief. <br><br> From the likelihood function and the prior distribution we get that the posterior distribution will be an updated beta distribution for each species in the plot. We note again that we only find this updated beta distribution for the species that are present in the plot. <span class="math display">\[
\theta | (Y = y) \sim \text{Beta}(\alpha + y, \beta + n-y)
\]</span> When the posterior distribution is found for a species in a given plot, we use the mean posterior as an estimate of the relative abundance for the species in the entire plot.</p>
<p><br> The mean of the posterior distribution is given by: <span class="math display">\[
E\Big[\theta|(Y =y)\Big] = \frac{\alpha + y}{\alpha + y+\beta + n-y} = \frac{\alpha +y}{\alpha+\beta+n}
\]</span> The interpretation of the mean of the posterior distribution is that it is an estimator of the proportion of a plot that a species cover. We will multiply this with <span class="math inline">\(n\)</span> so that it is easier to compare with cover data from the small square. Thus, for each species in the plot that is present we will obtain a new cover estimate of the entire plot given by <span class="math display">\[
\text{updated cover estimate} = n\cdot E\Big[\theta|(Y =y)\Big] = n\cdot \frac{\alpha +y}{\alpha+\beta+n}
\]</span> The interpretation of this is the following; we can imagine that we instead of placing <span class="math inline">\(n\)</span> pins within the small square of the plot, we now place the <span class="math inline">\(n\)</span> pins uniformly throughout the entire plot and get an estimate of how many pins a species would be hit by if we instead had collected the data in that fashion.</p>
<p>Following the construction of the model described above, we have succeeded in going from having only an abundance estimate of the small square in the plot to having an abundance estimate of the entire plot for each species that we know is present in the plot.</p>
<p>The next step for users of this method will be, as an example, to apply some diversity measures on the plot using the new updated data. Examples of different ways to measure diversity for an area are presented at the <a href="Diversity.html">Diversity</a> page.</p>
<h2>
Implementation
</h2>
<p>The above theory of the beta-binomial model are implemented in the function “beta_binomial_cover_update”.</p>
<p><strong>Usage:</strong></p>
<p>beta_binomial_cover_update(cover_data, presence_absence_data, n = 16 , remove_column = 0)</p>
<p><strong>Arguments:</strong></p>
<ul>
<li><strong>Cover_data</strong>: Data frame with plots as rows and species as columns. Each cell in the data frame contains cover data for a given species in a given plot.</li>
<li><strong>presence_absence_data</strong>: Data frame with plots as rows and species as columns. Each cell in the data frame contains a 1 if the specie is present in the plot or a 0 if the species is absent in the plot.</li>
<li><strong>n</strong>: An integer. A number each cell in the cover data gets divided by if the cover data is not in the interval <span class="math inline">\([0,1]\)</span>. In the NOVANA dataset n = 16 secures this property. If the cover data is already on the interval <span class="math inline">\([0,1]\)</span>, one can just let n = 1.<br />
</li>
<li><strong>remove_column</strong>: An integer. In case the first columns in the cover_data and presence_absence_data contain data not about the species but rather information on the plots, these columns have to be removed. The numbers of columns to be removed must be the same in the cover_data and presence/absence_data. The removed columns will be included again in the output. In the NOVANA dataset the first columns are “site”, “plot”, year" so remove_column = 3 when this dataset is applied.</li>
</ul>
<p><strong>Output</strong></p>
<ul>
<li>The function returns a data frame similar to the cover data but now containing new cover data estimated using the method outlined above.</li>
</ul>
<h2>
Calculated example
</h2>
To illustrate how to use this function we use the mini examples of cover data and presence/absence data that we presented on the <a href="Introduction.html">Introduction</a> page. The cover data look like:
<table class="table" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Species 1
</th>
<th style="text-align:right;">
Species 2
</th>
<th style="text-align:right;">
Species 3
</th>
<th style="text-align:right;">
Species 4
</th>
<th style="text-align:right;">
Species 5
</th>
<th style="text-align:right;">
Species 6
</th>
<th style="text-align:right;">
Species 7
</th>
<th style="text-align:right;">
Species 8
</th>
<th style="text-align:right;">
Species 9
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Plot 1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 3
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
11
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 7
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
5
</td>
</tr>
</tbody>
</table>
And the presence/absence data looks like:
<table class="table" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Species 1
</th>
<th style="text-align:right;">
Species 2
</th>
<th style="text-align:right;">
Species 3
</th>
<th style="text-align:right;">
Species 4
</th>
<th style="text-align:right;">
Species 5
</th>
<th style="text-align:right;">
Species 6
</th>
<th style="text-align:right;">
Species 7
</th>
<th style="text-align:right;">
Species 8
</th>
<th style="text-align:right;">
Species 9
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Plot 1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>We input the two datasets into our function</p>
<pre class="r"><code>beta_binomial_cover &lt;- beta_binomial_cover_update(Cover, PresenceAbsence, n = 16, remove_column = 0)</code></pre>
<p>The data from the outcome of the function looks like:</p>
<table class="table" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Species 1
</th>
<th style="text-align:right;">
Species 2
</th>
<th style="text-align:right;">
Species 3
</th>
<th style="text-align:right;">
Species 4
</th>
<th style="text-align:right;">
Species 5
</th>
<th style="text-align:right;">
Species 6
</th>
<th style="text-align:right;">
Species 7
</th>
<th style="text-align:right;">
Species 8
</th>
<th style="text-align:right;">
Species 9
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Plot 1
</td>
<td style="text-align:right;">
2.165401
</td>
<td style="text-align:right;">
0.2155853
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
2.178135
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
3.385214
</td>
<td style="text-align:right;">
0.6237624
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
2.374
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 2
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.2155853
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 3
</td>
<td style="text-align:right;">
5.041350
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
1.087547
</td>
<td style="text-align:right;">
9.334098
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
10.814527
</td>
<td style="text-align:right;">
6.1683168
</td>
<td style="text-align:right;">
15.093525
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 4
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
2.0497504
</td>
<td style="text-align:right;">
1.087547
</td>
<td style="text-align:right;">
8.538991
</td>
<td style="text-align:right;">
2.472973
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
3.7920792
</td>
<td style="text-align:right;">
9.453237
</td>
<td style="text-align:right;">
1.510
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 5
</td>
<td style="text-align:right;">
1.206751
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
15.759245
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
13.600519
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
10.150
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 6
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
1.1326678
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
1.527886
</td>
<td style="text-align:right;">
1.4158416
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Plot 7
</td>
<td style="text-align:right;">
15.586498
</td>
<td style="text-align:right;">
9.3864112
</td>
<td style="text-align:right;">
2.065660
</td>
<td style="text-align:right;">
6.948777
</td>
<td style="text-align:right;">
0.527027
</td>
<td style="text-align:right;">
12.671855
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
9.453237
</td>
<td style="text-align:right;">
4.966
</td>
</tr>
</tbody>
</table>
<p>It can be seen that <em>“Plot 2”</em> has 0 observations for all species in the cover data, but has a <em>“1”</em> in the presence/absence data for <em>“Species 2”</em>, indicating that the species is present in the plot but is not hit by any pins. In the beta binomial cover dataset <em>“Plot 2”</em> has a small value of 0.2155853 for <em>“Species 2”</em>. If a species is present in the plot but not hit by any pins, the beta binomial update model assigns a small value to it. If a species is not present in the plot, then the beta_binomial_cover_update function will not change the value, i.e. it will stay at 0. This can be seen for the other species in <em>“Plot 2”</em>.</p>
<p>When the species is present in the plot but not observed in the cover data, we have that <span class="math inline">\(n = 16\)</span> and <span class="math inline">\(y = 0\)</span>. Thus, the mean of the posterior distribution becomes:</p>
<p><span class="math display">\[
E\Big[\theta|(Y = 0)\Big] = \frac{\alpha}{\alpha+\beta+16}
\]</span> Because both <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are positive, we will get a small value as the relative cover of the species on the plot. The higher we have estimated the value of <span class="math inline">\(\alpha\)</span> in the prior distribution compared to the <span class="math inline">\(\beta\)</span>, the higher a value we will give the relative cover of the species in the plot despite the species not being observed in the small square.</p>
<p>The opposite is seen for <em>“plot 7”</em> with <em>“species 1”</em>. This has 16 in the cover data, but only 15,59 in the beta-binomial cover dataset, i.e. even though we know the species cover all of the small square we don’t believe that it covers the entire plot. This is because the prior distribution of the species plays role and contributes to the posterior distribution by taking the species’ spatially aggregated distribution into account.</p>
<p>When the number of pins that hits a species is equal to the number of pins that was used we have <span class="math inline">\(n\)</span> = 16 and <span class="math inline">\(y\)</span> = 16. We can again find the mean of the posterior distribution for this case:</p>
<p><span class="math display">\[
E\Big[\theta|(Y = 16)\Big] = \frac{\alpha +16}{\alpha+\beta+16}
\]</span></p>
<p>This has the the effect of lowering the relative cover estimate of the entire plot slightly compared to the observed cover we have of the species within the small square. The level at which the cover estimate is lowered depends on the estimated value of <span class="math inline">\(\beta\)</span>. The higher we have estimated the value of <span class="math inline">\(\beta\)</span> for the species compared to <span class="math inline">\(\alpha\)</span>, the less we will estimate the relative cover of the species in the entire plot.</p>
<p>A more detailed description of the implementation of the model can be found at <a href="bayesian_method_describtion.html">detailed description</a>. This page also includes the full code of the function with explanatory comments.</p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.0.3 (2020-10-10)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19042)

Matrix products: default

locale:
[1] LC_COLLATE=English_United Kingdom.1252 
[2] LC_CTYPE=English_United Kingdom.1252   
[3] LC_MONETARY=English_United Kingdom.1252
[4] LC_NUMERIC=C                           
[5] LC_TIME=English_United Kingdom.1252    

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] maps_3.3.0          fitdistrplus_1.1-3  survival_3.2-7     
 [4] MASS_7.3-53         magick_2.7.1        OpenStreetMap_0.3.4
 [7] kableExtra_1.3.4    forcats_0.5.0       stringr_1.4.0      
[10] dplyr_1.0.2         purrr_0.3.4         readr_1.4.0        
[13] tidyr_1.1.2         tibble_3.0.4        ggplot2_3.3.2      
[16] tidyverse_1.3.0    

loaded via a namespace (and not attached):
 [1] httr_1.4.2        jsonlite_1.7.1    viridisLite_0.3.0 splines_4.0.3    
 [5] modelr_0.1.8      assertthat_0.2.1  highr_0.8         sp_1.4-4         
 [9] blob_1.2.1        cellranger_1.1.0  yaml_2.2.1        pillar_1.4.6     
[13] backports_1.1.10  lattice_0.20-41   glue_1.4.2        digest_0.6.25    
[17] promises_1.1.1    rvest_0.3.6       colorspace_1.4-1  htmltools_0.5.0  
[21] httpuv_1.5.5      Matrix_1.2-18     pkgconfig_2.0.3   broom_0.7.2      
[25] raster_3.4-5      haven_2.3.1       scales_1.1.1      webshot_0.5.2    
[29] svglite_2.0.0     later_1.1.0.1     git2r_0.28.0      generics_0.0.2   
[33] ellipsis_0.3.1    withr_2.3.0       cli_2.1.0         magrittr_1.5     
[37] crayon_1.3.4      readxl_1.3.1      evaluate_0.14     fs_1.5.0         
[41] fansi_0.4.1       xml2_1.3.2        tools_4.0.3       hms_0.5.3        
[45] lifecycle_0.2.0   munsell_0.5.0     reprex_0.3.0      compiler_4.0.3   
[49] systemfonts_1.0.1 rlang_0.4.8       rstudioapi_0.11   rmarkdown_2.4    
[53] gtable_0.3.0      codetools_0.2-16  DBI_1.1.0         R6_2.4.1         
[57] lubridate_1.7.9   knitr_1.30        rgdal_1.5-23      workflowr_1.6.2  
[61] rprojroot_1.3-2   rJava_0.9-13      stringi_1.5.3     Rcpp_1.0.5       
[65] vctrs_0.3.4       dbplyr_1.4.4      tidyselect_1.1.0  xfun_0.18        </code></pre>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
